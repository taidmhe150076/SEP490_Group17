@page
@model COTSEClient.Pages.Presenters.ListParticiPantScoresModel
@{
    Layout = "_Layout";
}
<div class="container">
    <div class="table-responsive">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th scope="col">Level</th>
                    <th scope="col">TestName</th>
                    <th scope="col">ParticipantName</th>
                    <th scope="col">Score</th>
                </tr>
            </thead>
            <tbody id="table">
                @foreach (var item in Model.ListParticiPantScore)
                {
                    <tr>
                        <td style="width:100px;height:100px;"></td>
                        <td>@item.Test.TestName</td>
                        <td>@item.Participant.ParticipantsEmail</td>
                        <td>@item.Score</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
<script src="~/js/signalr/dist/browser/signalr.js"></script>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/jquery/dist/jquery.js"></script>
<script>
    var connection = new signalR.HubConnectionBuilder().withUrl("/particiPantScoresHub").build();
    connection.on("Message", function (ParticiPantScores) {
        console.log(ParticiPantScores);
        var particiPantScores = JSON.parse(ParticiPantScores);
        console.log(particiPantScores);
        $("#table").empty();
        var count = 1;
        particiPantScores.forEach(element => {
            var html = `
                        <tr>
                            <td>${count++}</td>
                            <td>${element.TestName}</td>
                            <td>${element.ParticipantName}</td>
                            <td>${element.Score}</td>
                        </tr>
                        `;
            if (count == 2) {
                html = `
                        <tr>
                                <td style="width:100px;height:100px;"><img style="width:100px;height:100px;" src="https://localhost:7149/Image/top1.png"></td>
                            <td>${element.TestName}</td>
                            <td>${element.ParticipantName}</td>
                            <td>${element.Score}</td>
                        </tr>
                        `;
            }
            if (count == 3) {
                html = `
                            <tr>
                                    <td style="width:100px;height:100px;"><img style="width:100px;height:100px;" src="https://localhost:7149/Image/top2.png"></td>
                                <td>${element.TestName}</td>
                                <td>${element.ParticipantName}</td>
                                <td>${element.Score}</td>
                            </tr>
                            `;
            }
            if (count == 4) {
                html = `
                        <tr>
                                <td style="width:100px;height:100px;"><img style="width:100px;height:100px;" src="https://localhost:7149/Image/top3.png"></td>
                            <td>${element.TestName}</td>
                            <td>${element.ParticipantName}</td>
                            <td>${element.Score}</td>
                        </tr>
                        `;
            }
            console.log(html);
            $("#table").append(html);
        });
    });

    connection.start().then(function () {
        console.log("Start nè ");
    }).catch(function (err) {
        return console.error(err.toString());
    });
</script>